@using FormsLibrary.Models;
@foreach (QuestionModel question in Segment.Questions)
{
    <MudPaper Width="90%" @onfocusin="@(() => currentQuestion = question)" @onfocusout="@(() => currentQuestion = new QuestionModel())" Class="align-self-center pa-2" Elevation="0" Style="@($"background-color: {Colors.Grey.Darken2}; border-left: 4px solid {CheckFocus(question)}")">
        <EditForm Model="question">
            <DataAnnotationsValidator />
            <MudCard Elevation="0">
                <MudCardContent Class="d-flex gap-2" Style="@($"background-color: {Colors.Grey.Darken2};")">
                    <MudTextField Label="Fråga"
                              @bind-Value="question.QuestionTitle"
                              For="@(() => question.QuestionTitle)"
                              Style="@($"color: {Colors.Grey.Lighten4}")"
                              Clearable="true" 
                              Variant="Variant.Filled" />
                    <MudSelect Placeholder="Typ av fråga..."
                           @bind-Value="question.QuestionOption"
                           For="@(() => question.QuestionOption)"
                           Style="@($"color: {Colors.Grey.Lighten5}")"
                           Variant="Variant.Outlined">
                        @foreach (QuestionOptions option in Enum.GetValues(typeof(QuestionOptions)))
                        {
                            <MudSelectItem Value="@option">@option</MudSelectItem>
                        }
                    </MudSelect>
                </MudCardContent>

                <QuestionContent Question="@question" />
            </MudCard>
        </EditForm>
    </MudPaper>
}

@code {
    // TODO: Fixa ChevronBottom oi så att den är inne i drop down rutan
    [Parameter]
    public SegmentModel Segment { get; set; } = new();

    private QuestionModel currentQuestion = new();

    public string CheckFocus(QuestionModel question)
    {
        if (currentQuestion == question)
        {
            return Colors.Grey.Lighten5;
        }
        return Colors.Grey.Darken2;
    }
}
